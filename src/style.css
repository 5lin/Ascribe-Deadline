@tailwind base;
@tailwind components;
@tailwind utilities;

@keyframes gradient-shift {

    0%,
    100% {
        background-position: 0% 50%;
    }

    50% {
        background-position: 100% 50%;
    }
}

.gradient-bg {
    background: linear-gradient(-45deg, #0f172a, #1e1b4b, #312e81, #1e1b4b);
    background-size: 400% 400%;
    animation: gradient-shift 15s ease infinite;
}

.glass {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.glass-light {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.number-gradient {
    background: linear-gradient(135deg, #a78bfa 0%, #818cf8 50%, #6366f1 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.scrollbar-hide::-webkit-scrollbar {
    display: none;
}

.scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
}

.emoji-btn {
    transition: all 0.2s;
}

.emoji-btn:hover {
    transform: scale(1.3);
}

.image-preview {
    position: relative;
    display: inline-block;
}

.image-preview .delete-btn {
    position: absolute;
    top: -8px;
    right: -8px;
    opacity: 0;
    transition: opacity 0.2s;
}

.image-preview:hover .delete-btn {
    opacity: 1;
}

.timeline-dot::before {
    content: '';
    position: absolute;
    left: -21px;
    top: 6px;
    width: 10px;
    height: 10px;
    background: linear-gradient(135deg, #a78bfa, #6366f1);
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
}

/* === 移动端优化 === */

/* 防止整体溢出 */
html,
body {
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
}

/* 触摸优化 */
* {
    -webkit-tap-highlight-color: transparent;
}

/* 移动端基础字体调整 */
@media (max-width: 640px) {

    /* 调整容器内边距 */
    .container {
        padding-left: 12px !important;
        padding-right: 12px !important;
        padding-top: 16px !important;
        padding-bottom: 16px !important;
    }

    /* 倒计时卡片优化 */
    .glass.rounded-3xl.p-8 {
        padding: 20px !important;
        border-radius: 20px !important;
    }

    /* 日历笔记卡片优化 */
    .glass-light.rounded-3xl.p-6 {
        padding: 16px !important;
        border-radius: 20px !important;
    }

    /* 倒计时数字响应式 */
    .number-gradient {
        font-size: 2rem !important;
        line-height: 1.2 !important;
    }

    /* 时间单位标签 */
    .text-xs.text-indigo-300.mt-2 {
        font-size: 10px !important;
        margin-top: 4px !important;
    }

    /* 日期显示文本 */
    .text-3xl.font-bold {
        font-size: 1.25rem !important;
    }

    /* 月份导航按钮 */
    .w-9.h-9 {
        width: 36px !important;
        height: 36px !important;
        min-width: 36px !important;
    }

    /* 月份显示文本 */
    .text-lg.font-bold.min-w-\[140px\] {
        font-size: 14px !important;
        min-width: 100px !important;
    }

    /* 时光轴按钮 */
    .px-4.py-2.bg-gradient-to-r {
        padding: 6px 12px !important;
        font-size: 12px !important;
    }

    /* 日历格子 - 更好的触摸区域 */
    .aspect-square {
        min-height: 36px;
    }

    .grid.grid-cols-7.gap-1 .text-sm {
        font-size: 12px !important;
    }

    /* 星期标题 */
    .text-center.text-xs.text-slate-400.py-2 {
        font-size: 10px !important;
        padding: 6px 0 !important;
    }

    /* 笔记区域优化 */
    textarea,
    .min-h-\[120px\] {
        min-height: 100px !important;
        font-size: 14px !important;
    }

    /* 工具按钮组 */
    .flex.items-center.gap-2.mb-3.flex-wrap {
        gap: 6px !important;
    }

    .px-3.py-1\.5 {
        padding: 8px 12px !important;
        font-size: 13px !important;
    }

    /* 进度条区域 */
    .flex.justify-between.text-sm.text-indigo-200 {
        font-size: 12px !important;
    }

    /* 图片预览更小 */
    .image-preview img {
        width: 48px !important;
        height: 48px !important;
    }

    /* 状态指示器调整位置 */
    .fixed.bottom-4.left-4 {
        bottom: 8px !important;
        left: 8px !important;
        padding: 6px 10px !important;
        font-size: 11px !important;
    }

    /* 顶部用户信息 */
    .flex.justify-end.mb-4 .glass.rounded-full {
        padding: 6px 12px !important;
    }

    .flex.justify-end.mb-4 .text-sm {
        font-size: 12px !important;
    }
}

/* 超小屏幕额外优化 (iPhone SE 等) */
@media (max-width: 375px) {
    .number-gradient {
        font-size: 1.5rem !important;
    }

    .grid.grid-cols-4.gap-4 {
        gap: 8px !important;
    }

    .text-3xl.font-bold {
        font-size: 1.1rem !important;
    }

    .aspect-square {
        min-height: 32px;
    }

    .grid.grid-cols-7.gap-1 .text-sm {
        font-size: 11px !important;
    }
}

/* 弹窗移动端优化 */
@media (max-width: 640px) {

    /* 设置弹窗 */
    .fixed.inset-0 .glass.rounded-3xl.p-6,
    .fixed.inset-0 .relative.glass.rounded-3xl.p-6 {
        margin: 12px !important;
        padding: 20px !important;
        max-height: calc(100vh - 24px) !important;
        overflow-y: auto !important;
    }

    /* 弹窗标题 */
    .text-xl.font-bold {
        font-size: 1.1rem !important;
    }

    /* 输入框优化 */
    .px-4.py-3 {
        padding: 12px 14px !important;
        font-size: 14px !important;
    }

    /* 弹窗按钮 */
    .flex.gap-3.mt-6 button,
    .space-y-4 button {
        padding: 12px !important;
        font-size: 14px !important;
    }
}

/* 时光轴移动端 */
@media (max-width: 640px) {
    .fixed.inset-0.z-50 .max-w-md {
        max-width: 100% !important;
        width: 100% !important;
    }

    .fixed.inset-0.z-50 .p-5 {
        padding: 16px !important;
    }

    /* 时光轴条目 */
    .timeline-dot .text-sm {
        font-size: 13px !important;
        line-height: 1.5 !important;
    }

    /* 时光轴图片 */
    .flex.flex-wrap.gap-2.mt-2 img {
        width: 60px !important;
        height: 60px !important;
    }
}

/* 表情选择器移动端 */
@media (max-width: 640px) {
    .absolute.top-full.left-0.mt-2.p-3.bg-white.rounded-xl {
        position: fixed !important;
        left: 12px !important;
        right: 12px !important;
        bottom: 50% !important;
        top: auto !important;
        transform: translateY(50%) !important;
        width: auto !important;
        max-width: calc(100vw - 24px) !important;
        z-index: 100 !important;
    }

    .grid.grid-cols-8.gap-1 {
        grid-template-columns: repeat(6, 1fr) !important;
    }

    .emoji-btn {
        font-size: 1.5rem !important;
        padding: 8px !important;
    }
}

/* 确保图片预览在移动端正常显示 */
@media (max-width: 640px) {
    .fixed.inset-0 img.max-w-full {
        max-width: calc(100vw - 32px) !important;
        max-height: calc(100vh - 32px) !important;
    }
}

/* 平板优化 */
@media (min-width: 641px) and (max-width: 1024px) {
    .container {
        padding-left: 20px !important;
        padding-right: 20px !important;
    }

    .number-gradient {
        font-size: 3rem !important;
    }
}

/* 安全区域支持 (iPhone X+ 刘海屏) */
@supports (padding: env(safe-area-inset-bottom)) {
    .fixed.bottom-4.left-4 {
        bottom: calc(8px + env(safe-area-inset-bottom)) !important;
        left: calc(8px + env(safe-area-inset-left)) !important;
    }

    @media (max-width: 640px) {
        .container {
            padding-bottom: calc(16px + env(safe-area-inset-bottom)) !important;
        }
    }
}

/* Transition animations */
.slide-enter-active,
.slide-leave-active {
    transition: all 0.3s ease;
}

.slide-enter-from,
.slide-leave-to {
    opacity: 0;
}

.slide-enter-from>div:last-child,
.slide-leave-to>div:last-child {
    transform: translateX(100%);
}

.fade-enter-active,
.fade-leave-active {
    transition: opacity 0.2s ease;
}

.fade-enter-from,
.fade-leave-to {
    opacity: 0;
}

/* === 增强动画效果 === */

/* 页面加载淡入 */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.container {
    animation: fadeIn 0.4s ease-out;
}

/* 卡片悬停效果 */
.glass,
.glass-light {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.glass:hover,
.glass-light:hover {
    transform: translateY(-2px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
}

/* 日历日期点击效果 */
.aspect-square {
    transition: all 0.15s ease;
}

.aspect-square:active {
    transform: scale(0.95);
}

/* 按钮点击动画 */
button {
    transition: all 0.15s ease;
}

button:active {
    transform: scale(0.97);
}

/* 图片加载动画 */
@keyframes shimmer {
    0% {
        background-position: -200px 0;
    }

    100% {
        background-position: 200px 0;
    }
}

.image-preview img {
    transition: opacity 0.3s ease;
}

.image-preview img[loading="true"] {
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200px 100%;
    animation: shimmer 1.5s infinite;
}

/* 图片加载淡入 */
.image-preview img {
    animation: fadeIn 0.3s ease;
}

/* 笔记输入框动画 */
textarea {
    transition: box-shadow 0.2s ease, border-color 0.2s ease;
}

textarea:focus {
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

/* 时光轴条目动画 */
.timeline-dot {
    animation: fadeIn 0.3s ease;
    animation-fill-mode: both;
}

.timeline-dot:nth-child(1) {
    animation-delay: 0.05s;
}

.timeline-dot:nth-child(2) {
    animation-delay: 0.1s;
}

.timeline-dot:nth-child(3) {
    animation-delay: 0.15s;
}

.timeline-dot:nth-child(4) {
    animation-delay: 0.2s;
}

.timeline-dot:nth-child(5) {
    animation-delay: 0.25s;
}

/* 倒计时数字动画 */
.number-gradient {
    transition: transform 0.3s ease;
}

/* 进度条动画 */
.bg-gradient-to-r {
    transition: width 0.5s ease;
}

/* Loading spinner */
@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

.animate-spin {
    animation: spin 1s linear infinite;
}

/* 脉冲效果 (用于状态指示器) */
@keyframes pulse {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.5;
    }
}

.bg-green-400 {
    animation: pulse 2s ease-in-out infinite;
}

/* 性能优化 */
.gradient-bg {
    will-change: background-position;
}

.glass,
.glass-light {
    will-change: transform;
}

/* GPU 加速 */
.image-preview img,
.number-gradient,
button {
    transform: translateZ(0);
    backface-visibility: hidden;
}